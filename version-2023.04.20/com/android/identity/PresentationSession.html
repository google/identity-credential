<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>PresentationSession (identity 2023.04.20 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PresentationSession (identity 2023.04.20 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="Versionbox">
<li><a href="../../../../versions.html"><span id="version">Version 2023.04.20 â–¼</span></a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.android.identity</a></div>
<h2 title="Class PresentationSession" class="title">Class PresentationSession</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.android.identity.PresentationSession</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="HardwarePresentationSession.html" title="class in com.android.identity">HardwarePresentationSession</a></code></dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">PresentationSession</span>
extends java.lang.Object</pre>
<div class="block">Class for presenting multiple documents to a remote verifier.

 <p>This should be used for all interactions with a remote verifier instead of the now deprecated
 <a href="IdentityCredential.html#getEntries(byte%5B%5D,java.util.Map,byte%5B%5D)"><code>IdentityCredential.getEntries(byte[], Map, byte[])</code></a> method.

 Use <a href="IdentityCredentialStore.html#createPresentationSession(int)"><code>IdentityCredentialStore.createPresentationSession(int)</code></a> to create a <a href="PresentationSession.html" title="class in com.android.identity"><code>PresentationSession</code></a> instance.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>abstract <a href="CredentialDataResult.html" title="class in com.android.identity">CredentialDataResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCredentialData(java.lang.String,com.android.identity.CredentialDataRequest)">getCredentialData</a></span>&#8203;(java.lang.String&nbsp;credentialName,
                 <a href="CredentialDataRequest.html" title="class in com.android.identity">CredentialDataRequest</a>&nbsp;request)</code></th>
<td class="colLast">
<div class="block">Retrieves data from a named credential in the current presentation session.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>abstract androidx.biometric.BiometricPrompt.CryptoObject</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCryptoObject()">getCryptoObject</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets a <code>BiometricPrompt.CryptoObject</code> which can be used with this
 <a href="PresentationSession.html" title="class in com.android.identity"><code>PresentationSession</code></a>.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>abstract java.security.KeyPair</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getEphemeralKeyPair()">getEphemeralKeyPair</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the ephemeral key pair to use to establish a secure channel with the verifier.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setReaderEphemeralPublicKey(java.security.PublicKey)">setReaderEphemeralPublicKey</a></span>&#8203;(java.security.PublicKey&nbsp;readerEphemeralPublicKey)</code></th>
<td class="colLast">
<div class="block">Set the ephemeral public key provided by the verifier.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setSessionTranscript(byte%5B%5D)">setSessionTranscript</a></span>&#8203;(byte[]&nbsp;sessionTranscript)</code></th>
<td class="colLast">
<div class="block">Set the session transcript.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getEphemeralKeyPair()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getEphemeralKeyPair</h4>
<pre class="methodSignature">@NonNull
public abstract&nbsp;java.security.KeyPair&nbsp;getEphemeralKeyPair()</pre>
<div class="block">Gets the ephemeral key pair to use to establish a secure channel with the verifier.

 <p>Applications should use this key-pair for the communications channel with the verifier
 using a protocol / cipher-suite appropriate for the application. One example of such a
 protocol is the one used for Mobile Driving Licenses, see ISO 18013-5.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ephemeral key pair to use to establish a secure channel with a reader.</dd>
</dl>
</li>
</ul>
<a id="setReaderEphemeralPublicKey(java.security.PublicKey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setReaderEphemeralPublicKey</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;setReaderEphemeralPublicKey&#8203;(@NonNull
                                                 java.security.PublicKey&nbsp;readerEphemeralPublicKey)
                                          throws java.security.InvalidKeyException</pre>
<div class="block">Set the ephemeral public key provided by the verifier.

 <p>If called, this must be called before any calls to <a href="#getCredentialData(java.lang.String,com.android.identity.CredentialDataRequest)"><code>getCredentialData(String,
 CredentialDataRequest)</code></a>.

 <p>This method can only be called once per <a href="PresentationSession.html" title="class in com.android.identity"><code>PresentationSession</code></a> instance.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>readerEphemeralPublicKey</code> - The ephemeral public key provided by the reader to
                                 establish a secure session.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.InvalidKeyException</code> - if the given key is invalid.</dd>
</dl>
</li>
</ul>
<a id="setSessionTranscript(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSessionTranscript</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;setSessionTranscript&#8203;(@NonNull
                                          byte[]&nbsp;sessionTranscript)</pre>
<div class="block">Set the session transcript.

 <p>If called, this must be called before any calls to <a href="#getCredentialData(java.lang.String,com.android.identity.CredentialDataRequest)"><code>getCredentialData(String,
 CredentialDataRequest)</code></a>.

 <p>The X and Y coordinates of the public part of the key-pair returned by <a href="#getEphemeralKeyPair()"><code>getEphemeralKeyPair()</code></a> must appear somewhere in the bytes of the passed in CBOR.  Each of
 these coordinates must appear encoded with the most significant bits first and use the exact
 amount of bits indicated by the key size of the ephemeral keys. For example, if the
 ephemeral key is using the P-256 curve then the 32 bytes for the X coordinate encoded with
 the most significant bits first must appear somewhere and ditto for the 32 bytes for the Y
 coordinate.

 <p>This method can only be called once per <a href="PresentationSession.html" title="class in com.android.identity"><code>PresentationSession</code></a> instance.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sessionTranscript</code> - the session transcript.</dd>
</dl>
</li>
</ul>
<a id="getCredentialData(java.lang.String,com.android.identity.CredentialDataRequest)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCredentialData</h4>
<pre class="methodSignature">@Nullable
public abstract&nbsp;<a href="CredentialDataResult.html" title="class in com.android.identity">CredentialDataResult</a>&nbsp;getCredentialData&#8203;(@NonNull
                                                       java.lang.String&nbsp;credentialName,
                                                       @NonNull
                                                       <a href="CredentialDataRequest.html" title="class in com.android.identity">CredentialDataRequest</a>&nbsp;request)
                                                throws <a href="NoAuthenticationKeyAvailableException.html" title="class in com.android.identity">NoAuthenticationKeyAvailableException</a>,
                                                       <a href="InvalidReaderSignatureException.html" title="class in com.android.identity">InvalidReaderSignatureException</a>,
                                                       <a href="InvalidRequestMessageException.html" title="class in com.android.identity">InvalidRequestMessageException</a>,
                                                       <a href="EphemeralPublicKeyNotFoundException.html" title="class in com.android.identity">EphemeralPublicKeyNotFoundException</a></pre>
<div class="block">Retrieves data from a named credential in the current presentation session.

 <p>If an access control check fails for one of the requested entries or if the entry
 doesn't exist, the entry is simply not returned. The application can detect this
 by using the <a href="CredentialDataResult.Entries.html#getStatus(java.lang.String,java.lang.String)"><code>CredentialDataResult.Entries.getStatus(String, String)</code></a> method on
 each of the requested entries.

 <p>The application should not make any assumptions on whether user authentication is needed.
 Instead, the application should request the data elements values first and then examine
 the returned <a href="CredentialDataResult.html" title="class in com.android.identity"><code>CredentialDataResult</code></a>. If
 <a href="CredentialDataResult.Entries.html#STATUS_USER_AUTHENTICATION_FAILED"><code>CredentialDataResult.Entries.STATUS_USER_AUTHENTICATION_FAILED</code></a> is returned the
 application should call <a href="#getCryptoObject()"><code>getCryptoObject()</code></a> and use the returned
 <code>BiometricPrompt.CryptoObject</code> with a
 <code>BiometricPrompt</code>. Upon successful authentication the application
 may call <a href="#getCredentialData(java.lang.String,com.android.identity.CredentialDataRequest)"><code>getCredentialData(String, CredentialDataRequest)</code></a> again.

 <p>It is permissible to call this method multiple times using the same credential name.
 If this is done the same auth-key will be used.

 <p>If the reader signature is set in the request parameter (via the
 <a href="CredentialDataRequest.Builder.html#setReaderSignature(byte%5B%5D)"><code>CredentialDataRequest.Builder.setReaderSignature(byte[])</code></a> method) it must contain
 the bytes of a <code>COSE_Sign1</code> structure as defined in RFC 8152. For the payload
 <code>nil</code> shall be used and the detached payload is the <code>ReaderAuthenticationBytes</code>
 CBOR described below.
 <pre>
     ReaderAuthentication = [
       "ReaderAuthentication",
       SessionTranscript,
       ItemsRequestBytes
     ]

     ItemsRequestBytes = #6.24(bstr .cbor ItemsRequest)

     ReaderAuthenticationBytes = #6.24(bstr .cbor ReaderAuthentication)
 </pre>

 <p>where <code>ItemsRequestBytes</code> are the bytes of the request message set in
 the request parameter (via the
 <a href="CredentialDataRequest.Builder.html#setRequestMessage(byte%5B%5D)"><code>CredentialDataRequest.Builder.setRequestMessage(byte[])</code></a> method).

 <p>The public key corresponding to the key used to make the signature, can be found in the
 <code>x5chain</code> unprotected header element of the <code>COSE_Sign1</code> structure (as as
 described in
 <a href="https://tools.ietf.org/html/draft-ietf-cose-x509-08">draft-ietf-cose-x509-08</a>).
 There will be at least one certificate in said element and there may be more (and if so,
 each certificate must be signed by its successor).

 <p>Data elements protected by reader authentication are returned if, and only if,
 <code>requestMessage</code> is signed by the top-most certificate in the reader's certificate
 chain, and the data element is configured with an <a href="AccessControlProfile.html" title="class in com.android.identity"><code>AccessControlProfile</code></a> configured
 with an X.509 certificate for a key which appear in the certificate chain.

 <p>Note that the request message CBOR is used only for enforcing reader authentication, it's
 not used for determining which entries this API will return. The application is expected to
 have parsed the request message and filtered it according to user preference and/or consent.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>credentialName</code> - the name of the credential to retrieve.</dd>
<dd><code>request</code> - the data to retrieve from the credential</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>If the credential wasn't found, returns null. Otherwise a
         <a href="CredentialDataResult.html" title="class in com.android.identity"><code>CredentialDataResult</code></a> object containing entry data organized by namespace and
         a cryptographically authenticated representation of the same data, bound to the
         current session.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="NoAuthenticationKeyAvailableException.html" title="class in com.android.identity">NoAuthenticationKeyAvailableException</a></code> - if authentication keys were never
                                                provisioned for the credential or if they
                                                are expired or exhausted their use-count.</dd>
<dd><code><a href="InvalidRequestMessageException.html" title="class in com.android.identity">InvalidRequestMessageException</a></code> - if the requestMessage is malformed.</dd>
<dd><code><a href="InvalidReaderSignatureException.html" title="class in com.android.identity">InvalidReaderSignatureException</a></code> - if the reader signature is invalid, or it
                                                doesn't contain a certificate chain, or if
                                                the signature failed to validate.</dd>
<dd><code><a href="EphemeralPublicKeyNotFoundException.html" title="class in com.android.identity">EphemeralPublicKeyNotFoundException</a></code> - if the ephemeral public key was not found in
                                                the session transcript.</dd>
<dd><code><a href="CredentialInvalidatedException.html" title="class in com.android.identity">CredentialInvalidatedException</a></code> - if the credential has been invalidated</dd>
</dl>
</li>
</ul>
<a id="getCryptoObject()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getCryptoObject</h4>
<pre class="methodSignature">@Nullable
public abstract&nbsp;androidx.biometric.BiometricPrompt.CryptoObject&nbsp;getCryptoObject()</pre>
<div class="block">Gets a <code>BiometricPrompt.CryptoObject</code> which can be used with this
 <a href="PresentationSession.html" title="class in com.android.identity"><code>PresentationSession</code></a>.

 <p>If <a href="IdentityCredential.html" title="class in com.android.identity"><code>IdentityCredential</code></a> is hardware-backed, the returned
 <code>BiometricPrompt.CryptoObject</code> is associated
 android.security.identity.PresentationSession object from the Android Framework.
 If it's not hardware-backed it's not defined which kind of object it's associated with.
 Because of this, this method is the preferred way
 to obtain a <code>BiometricPrompt.CryptoObject</code> rather than to construct it
 manually.

 <p>If no biometrics are enrolled on the device or if the device doesn't support biometrics
 the value <code>null</code> may be returned. This just means the application won't have a
 <code>BiometricPrompt.CryptoObject</code> to pass to <code>BiometricPrompt</code> and will have to
 pass <code>null</code> instead.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A <code>BiometricPrompt.CryptoObject</code> which can be used with
 <code>BiometricPrompt</code>.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
